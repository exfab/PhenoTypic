
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6. Fitting Logistic Growth Curves &#8212; PhenoTypic</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=800a184d" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=b3db6a4d"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/tutorial/notebooks/GrowthCurves';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Examples" href="../../examples/index.html" />
    <link rel="prev" title="5. Make your own ImagePipeline" href="ImagePipelines.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.11.1" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/gradient_logo_exfab.svg" class="logo__image only-light" alt="PhenoTypic"/>
    <img src="../../../_static/gradient_logo_exfab.svg" class="logo__image only-dark pst-js-only" alt="PhenoTypic"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../api_reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../contrib_guide/index.html">
    Developer Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../downloadables.html">
    Downloads
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Wheeldon-Lab/PhenoScope#" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../api_reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../contrib_guide/index.html">
    Developer Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../downloadables.html">
    Downloads
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Wheeldon-Lab/PhenoScope#" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide Topics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="GettingStarted.html">1. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="LongerStart.html">2. Using <code class="docutils literal notranslate"><span class="pre">ImagePipeline</span></code>s to process batches</a></li>
<li class="toctree-l2"><a class="reference internal" href="Images.html">3. Understanding the Image Class: Data Components and Accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="GridImages.html">4. Working with GridImage: Grid-Specific Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="ImagePipelines.html">5. Make your own <code class="docutils literal notranslate"><span class="pre">ImagePipeline</span></code></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6. Fitting Logistic Growth Curves</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/index.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">6. Fitting Logistic Growth Curves</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="6.-Fitting-Logistic-Growth-Curves">
<h1>6. Fitting Logistic Growth Curves<a class="headerlink" href="#6.-Fitting-Logistic-Growth-Curves" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<section id="Background">
<h2>Background<a class="headerlink" href="#Background" title="Link to this heading">#</a></h2>
<p>In this tutorial we will cover how to fit growth curves on data from PhenoTypic. For growth curves you’ll typically want to use metrics of size from <code class="docutils literal notranslate"><span class="pre">pht.measure.MeasureSize</span></code>: “Size_Area” or “Size_IntegratedIntensity”. These can also be obtained from <code class="docutils literal notranslate"><span class="pre">pht.measure.MeasureArea</span></code> or <code class="docutils literal notranslate"><span class="pre">pht.measure.MeasureIntensity</span></code> respectively.</p>
<p>Size Metric Comparison:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Metric</p></th>
<th class="head"><p>Pros</p></th>
<th class="head"><p>Cons</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“Shape_Area”</p></td>
<td><p>Simple to set up Captures lateral growth</p></td>
<td><p>Misses Vertical Growth</p></td>
</tr>
<tr class="row-odd"><td><p>“Intensity_IntegratedIntensity”</p></td>
<td><p>Captures lateral and vertical growth</p></td>
<td><p>Requires color correction if there’s significant color drift or lots of color variation between colonies</p></td>
</tr>
</tbody>
</table>
</div>
<p>Phenotypic uses the following form of the logistic formula:</p>
<section id="Logistic-Kinetics-Model">
<h3>Logistic Kinetics Model<a class="headerlink" href="#Logistic-Kinetics-Model" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(N(t) = \frac{K } {1 + \frac{K - N0}{N0} e^{-r t}}\)</span></p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(N_t\)</span>: population size at time t</p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(N_0\)</span>: initial population size at time t</p>
<p><span class="math notranslate nohighlight">\(r\)</span>: growth rate</p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(K\)</span>: Carrying capacity (maximum population size).</p>
</div></blockquote>
<p>from which we can derive:</p>
<p><span class="math notranslate nohighlight">\(µ_{max} = \frac{Kr}{4}\)</span></p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(µ_{max}\)</span>: maximum specific growth rate</p>
</div></blockquote>
<p>To solver for the parameters, we use the following loss function with the scipy linear least squares solver</p>
</section>
<section id="Loss-Function">
<h3>Loss Function<a class="headerlink" href="#Loss-Function" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(J(K,N_0,r) = \frac{1}{n}\sum_{i=1}^{n}\frac{1}{2}(f_{K,N0,r}(t^{(i)}) - N_t^{(i)})^2) + \lambda(\frac{dN}{dt}^2 + N_0^2) + \alpha \frac{\lvert K-\max({N_t})\rvert}{N_t}\)</span></p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\lambda\)</span>: regularization term for growth rate and initial population size</p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\alpha\)</span>: penalty term for deviations in the carrying capacity relative to the largest measurement</p>
</div></blockquote>
</section>
</section>
<section id="Overview">
<h2>Overview<a class="headerlink" href="#Overview" title="Link to this heading">#</a></h2>
<p>The data in this tutorial comes from the {doc} <code class="docutils literal notranslate"><span class="pre">QuickStart</span></code> tutorial</p>
<p>In this tutorial we use the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pht.analysis.LogGrowthModel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pht.analysis.TukeysOutlierRemover</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pht.analysis.EdgeCorrector</span></code></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">phenotypic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pht</span>

<span class="n">meas</span> <span class="o">=</span> <span class="n">pht</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load_quickstart_meas</span><span class="p">()</span>
<span class="n">meas</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Adding-in-metadata-post-analysis-for-downstream-processing">
<h2>Adding in metadata post-analysis for downstream processing<a class="headerlink" href="#Adding-in-metadata-post-analysis-for-downstream-processing" title="Link to this heading">#</a></h2>
<p>The original naming rule for this data was <code class="docutils literal notranslate"><span class="pre">{Time}_{PlateSet}{Media}_{Replicate}</span></code></p>
<p>Based on this naming rule, let’s add the remaining metadata. These methods are all from <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<p>Note: This was the original naming rule, but it leads to some awkward splitting. It’s usually better to separate independent variables with underscores and related variables with dashes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># We split the ImageName using string and then unpack that into three new columns in the dataframe</span>
<span class="n">meas</span><span class="p">[[</span><span class="s2">&quot;Metadata_Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_SetMedia&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Replicate&quot;</span><span class="p">]]</span> <span class="o">=</span> \
    <span class="n">meas</span><span class="p">[</span><span class="s2">&quot;Metadata_ImageName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Lets now split the {PlateSet}{Media} into different columns too</span>
<span class="n">meas</span><span class="p">[[</span><span class="s2">&quot;Metadata_PlateSet&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Media&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">meas</span><span class="p">[</span><span class="s2">&quot;Metadata_SetMedia&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="c1"># Time is a number, but because we split it from its name we need to convert it to the proper datatype</span>
<span class="n">meas</span><span class="p">[</span><span class="s2">&quot;Metadata_Time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meas</span><span class="p">[</span><span class="s2">&quot;Metadata_Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">meas</span><span class="p">[</span><span class="s2">&quot;Metadata_PlateSet&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meas</span><span class="p">[</span><span class="s2">&quot;Metadata_PlateSet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Lets see our newest changes</span>
<span class="n">meas</span><span class="p">[[</span><span class="s2">&quot;Metadata_ImageName&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_PlateSet&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Media&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Replicate&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Metadata_ImageName</th>
      <th>Metadata_Time</th>
      <th>Metadata_PlateSet</th>
      <th>Metadata_Media</th>
      <th>Metadata_Replicate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2_1S_5</td>
      <td>2</td>
      <td>1</td>
      <td>S</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2_1S_5</td>
      <td>2</td>
      <td>1</td>
      <td>S</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2_1S_5</td>
      <td>2</td>
      <td>1</td>
      <td>S</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2_1S_5</td>
      <td>2</td>
      <td>1</td>
      <td>S</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2_1S_5</td>
      <td>2</td>
      <td>1</td>
      <td>S</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Adding-in-metadata-like-strain-name">
<h2>Adding in metadata like strain name<a class="headerlink" href="#Adding-in-metadata-like-strain-name" title="Link to this heading">#</a></h2>
<p>While you can add the metadata per-image, its necessary to add it in post-extraction for things like colony strain names. To add in metadata like the strain name for each column to your data, we’ll use table joining.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># Lets generate a synthetic table of strain names</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># It&#39;s important to use the same names as the measurement dataframe</span>
<span class="n">synth_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;Metadata_PlateSet&quot;</span>  <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;Grid_SectionNum&quot;</span>    <span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">96</span><span class="p">),</span>
    <span class="s2">&quot;Metadata_StrainName&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;SYNTH-</span><span class="si">{</span><span class="n">idx</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">96</span><span class="p">)],</span>
<span class="p">})</span>

<span class="n">synth_names</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Metadata_PlateSet</th>
      <th>Grid_SectionNum</th>
      <th>Metadata_StrainName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>SYNTH-00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>SYNTH-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2</td>
      <td>SYNTH-02</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>SYNTH-03</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>4</td>
      <td>SYNTH-04</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>91</th>
      <td>1</td>
      <td>91</td>
      <td>SYNTH-91</td>
    </tr>
    <tr>
      <th>92</th>
      <td>1</td>
      <td>92</td>
      <td>SYNTH-92</td>
    </tr>
    <tr>
      <th>93</th>
      <td>1</td>
      <td>93</td>
      <td>SYNTH-93</td>
    </tr>
    <tr>
      <th>94</th>
      <td>1</td>
      <td>94</td>
      <td>SYNTH-94</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1</td>
      <td>95</td>
      <td>SYNTH-95</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 3 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">meas</span> <span class="o">=</span> <span class="n">meas</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">synth_names</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Metadata_PlateSet&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid_SectionNum&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="n">meas</span><span class="p">[[</span><span class="s2">&quot;Metadata_PlateSet&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid_SectionNum&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_StrainName&quot;</span><span class="p">,</span> <span class="s2">&quot;Shape_Area&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Metadata_FileSuffix</th>
      <th>Metadata_BitDepth</th>
      <th>Metadata_ImageType</th>
      <th>Metadata_ImageName</th>
      <th>ObjectLabel</th>
      <th>Bbox_CenterRR</th>
      <th>Bbox_CenterCC</th>
      <th>Bbox_MinRR</th>
      <th>Bbox_MinCC</th>
      <th>Bbox_MaxRR</th>
      <th>...</th>
      <th>ColorHSV_BrightnessStdDev</th>
      <th>ColorHSV_BrightnessCoeffVar</th>
      <th>ColorLab_ChromaEstimatedMean</th>
      <th>ColorLab_ChromaEstimatedMedian</th>
      <th>Metadata_Time</th>
      <th>Metadata_SetMedia</th>
      <th>Metadata_Replicate</th>
      <th>Metadata_PlateSet</th>
      <th>Metadata_Media</th>
      <th>Metadata_StrainName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>.jpg</td>
      <td>8</td>
      <td>GridImage</td>
      <td>2_1S_5</td>
      <td>1</td>
      <td>143.066954</td>
      <td>638.928742</td>
      <td>116</td>
      <td>616</td>
      <td>171</td>
      <td>...</td>
      <td>0.020981</td>
      <td>0.068122</td>
      <td>2.324505</td>
      <td>2.412023</td>
      <td>2</td>
      <td>1S</td>
      <td>5</td>
      <td>1</td>
      <td>S</td>
      <td>SYNTH-03</td>
    </tr>
    <tr>
      <th>1</th>
      <td>.jpg</td>
      <td>8</td>
      <td>GridImage</td>
      <td>2_1S_5</td>
      <td>2</td>
      <td>150.888348</td>
      <td>489.121803</td>
      <td>122</td>
      <td>464</td>
      <td>182</td>
      <td>...</td>
      <td>0.049686</td>
      <td>0.131528</td>
      <td>2.861581</td>
      <td>3.057672</td>
      <td>2</td>
      <td>1S</td>
      <td>5</td>
      <td>1</td>
      <td>S</td>
      <td>SYNTH-02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>.jpg</td>
      <td>8</td>
      <td>GridImage</td>
      <td>2_1S_5</td>
      <td>3</td>
      <td>152.518557</td>
      <td>962.014356</td>
      <td>122</td>
      <td>934</td>
      <td>185</td>
      <td>...</td>
      <td>0.046833</td>
      <td>0.115846</td>
      <td>3.028543</td>
      <td>3.214427</td>
      <td>2</td>
      <td>1S</td>
      <td>5</td>
      <td>1</td>
      <td>S</td>
      <td>SYNTH-05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>.jpg</td>
      <td>8</td>
      <td>GridImage</td>
      <td>2_1S_5</td>
      <td>4</td>
      <td>152.439723</td>
      <td>1610.904644</td>
      <td>125</td>
      <td>1589</td>
      <td>182</td>
      <td>...</td>
      <td>0.045290</td>
      <td>0.116357</td>
      <td>4.114455</td>
      <td>4.538226</td>
      <td>2</td>
      <td>1S</td>
      <td>5</td>
      <td>1</td>
      <td>S</td>
      <td>SYNTH-09</td>
    </tr>
    <tr>
      <th>4</th>
      <td>.jpg</td>
      <td>8</td>
      <td>GridImage</td>
      <td>2_1S_5</td>
      <td>5</td>
      <td>156.673430</td>
      <td>802.163285</td>
      <td>129</td>
      <td>779</td>
      <td>185</td>
      <td>...</td>
      <td>0.043493</td>
      <td>0.113999</td>
      <td>2.941698</td>
      <td>3.139710</td>
      <td>2</td>
      <td>1S</td>
      <td>5</td>
      <td>1</td>
      <td>S</td>
      <td>SYNTH-04</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 178 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># Lets isolate the measurements we care about</span>
<span class="n">meas</span> <span class="o">=</span> <span class="p">(</span><span class="n">meas</span><span class="p">[[</span><span class="s2">&quot;Metadata_ImageName&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid_SectionNum&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Media&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_PlateSet&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Replicate&quot;</span><span class="p">,</span>
              <span class="s2">&quot;Metadata_StrainName&quot;</span><span class="p">,</span>
              <span class="s2">&quot;Metadata_Time&quot;</span><span class="p">,</span>
              <span class="s2">&quot;Shape_Area&quot;</span><span class="p">]]</span>
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Metadata_StrainName&#39;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Time&quot;</span><span class="p">]))</span>

<span class="n">meas</span><span class="p">[</span><span class="s2">&quot;Metadata_Time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meas</span><span class="p">[</span><span class="s2">&quot;Metadata_Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># Ensures that the time column is numeric</span>
<span class="n">meas</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Metadata_ImageName</th>
      <th>Grid_SectionNum</th>
      <th>Metadata_Media</th>
      <th>Metadata_PlateSet</th>
      <th>Metadata_Replicate</th>
      <th>Metadata_StrainName</th>
      <th>Metadata_Time</th>
      <th>Shape_Area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>2_1S_5</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>5</td>
      <td>SYNTH-00</td>
      <td>2</td>
      <td>2295.0</td>
    </tr>
    <tr>
      <th>89</th>
      <td>2_1S_6</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>6</td>
      <td>SYNTH-00</td>
      <td>2</td>
      <td>2420.0</td>
    </tr>
    <tr>
      <th>171</th>
      <td>2_1S_7</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>7</td>
      <td>SYNTH-00</td>
      <td>2</td>
      <td>2751.0</td>
    </tr>
    <tr>
      <th>315</th>
      <td>3_1S_5</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>5</td>
      <td>SYNTH-00</td>
      <td>3</td>
      <td>2676.0</td>
    </tr>
    <tr>
      <th>401</th>
      <td>3_1S_6</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>6</td>
      <td>SYNTH-00</td>
      <td>3</td>
      <td>2877.0</td>
    </tr>
    <tr>
      <th>485</th>
      <td>3_1S_7</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>7</td>
      <td>SYNTH-00</td>
      <td>3</td>
      <td>3206.0</td>
    </tr>
    <tr>
      <th>568</th>
      <td>3_1S_8</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>8</td>
      <td>SYNTH-00</td>
      <td>3</td>
      <td>2840.0</td>
    </tr>
    <tr>
      <th>651</th>
      <td>4_1S_5</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>5</td>
      <td>SYNTH-00</td>
      <td>4</td>
      <td>2948.0</td>
    </tr>
    <tr>
      <th>740</th>
      <td>4_1S_6</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>6</td>
      <td>SYNTH-00</td>
      <td>4</td>
      <td>3413.0</td>
    </tr>
    <tr>
      <th>826</th>
      <td>4_1S_7</td>
      <td>0</td>
      <td>S</td>
      <td>1</td>
      <td>7</td>
      <td>SYNTH-00</td>
      <td>4</td>
      <td>3535.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Filtering-and-correction">
<h2>Filtering and correction<a class="headerlink" href="#Filtering-and-correction" title="Link to this heading">#</a></h2>
<p>In automated image processing, depending on the scene, objects can be:</p>
<ul class="simple">
<li><p>oversegmented (some of the background is detected along with the object)</p></li>
<li><p>undersegmented (some of the object is not detected with the object)</p></li>
<li><p>noise that was detected as an object</p></li>
</ul>
<p>Other factors that may mess with our growth curves include stochastic biological noise or experimental error as well. To refine the data to reflect the true growth kinetics better, we can apply tukey’s outlier and our edge correction method on the dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">phenotypic.analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">TukeyOutlierRemover</span>

<span class="n">tukey_outlier_analysis</span> <span class="o">=</span> <span class="n">TukeyOutlierRemover</span><span class="p">(</span>
        <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Shape_Area&quot;</span><span class="p">,</span>
        <span class="n">groupby</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Metadata_StrainName&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Time&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">tukey_results</span> <span class="o">=</span> <span class="n">tukey_outlier_analysis</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">meas</span><span class="p">)</span>

<span class="n">tukey_outlier_analysis</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">collapsed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Warning: Displaying only first 20 of 451 groups
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 1000x1200 with 1 Axes&gt;,
 &lt;Axes: xlabel=&#39;Shape_Area&#39;, ylabel=&#39;Group&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_tutorial_notebooks_GrowthCurves_9_2.png" src="../../../_images/user_guide_tutorial_notebooks_GrowthCurves_9_2.png" />
</div>
</div>
<blockquote>
<div><p>Since there’s a large amount of groups and they can’t all be displayed, only the first 20 are displayed, but this can be changed.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">phenotypic.analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">EdgeCorrector</span>

<span class="n">edge_correcter</span> <span class="o">=</span> <span class="n">EdgeCorrector</span><span class="p">(</span>
        <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Shape_Area&quot;</span><span class="p">,</span>
        <span class="n">groupby</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Metadata_PlateSet&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Media&quot;</span><span class="p">,</span> <span class="s2">&quot;Metadata_Replicate&quot;</span><span class="p">],</span>
        <span class="n">time_label</span><span class="o">=</span><span class="s2">&quot;Metadata_Time&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">edge_corrected</span> <span class="o">=</span> <span class="n">edge_correcter</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">tukey_results</span><span class="p">)</span>
<span class="n">edge_correcter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">collapsed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 1000x600 with 1 Axes&gt;,
 &lt;Axes: title={&#39;center&#39;: &#39;Edge Correction (Top N=3, p=0.05)&#39;}, xlabel=&#39;Shape_Area&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_tutorial_notebooks_GrowthCurves_11_1.png" src="../../../_images/user_guide_tutorial_notebooks_GrowthCurves_11_1.png" />
</div>
</div>
</section>
<section id="Fit-model">
<h2>Fit model<a class="headerlink" href="#Fit-model" title="Link to this heading">#</a></h2>
<p><strong>New parameters:</strong> &gt; <code class="docutils literal notranslate"><span class="pre">lam</span></code>: The regularization factor for specific growth rate &gt; <code class="docutils literal notranslate"><span class="pre">alpha</span></code>: The penalty term for the relative deviation from the max of the carrying capacity</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">log_model</span> <span class="o">=</span> <span class="n">pht</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">LogGrowthModel</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;Shape_Area&#39;</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Metadata_StrainName&#39;</span><span class="p">],</span>
                                        <span class="n">agg_func</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
                                        <span class="n">time_label</span><span class="o">=</span><span class="s1">&#39;Metadata_Time&#39;</span><span class="p">,</span>
                                        <span class="n">lam</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                        <span class="n">alpha</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
                                        <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model_fit</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">meas</span><span class="p">)</span>
<span class="n">model_fit</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Metadata_StrainName</th>
      <th>LogGrowthModel_r</th>
      <th>LogGrowthModel_K</th>
      <th>LogGrowthModel_N0</th>
      <th>LogGrowthModel_µmax</th>
      <th>LogGrowthModel_Kmax</th>
      <th>LogGrowthModel_NumSamples</th>
      <th>LogGrowthModel_OptimizerLoss</th>
      <th>LogGrowthModel_OptimizerStatus</th>
      <th>LogGrowthModel_MAE</th>
      <th>LogGrowthModel_MSE</th>
      <th>LogGrowthModel_RMSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SYNTH-00</td>
      <td>0.882962</td>
      <td>3803.000000</td>
      <td>731.050357</td>
      <td>839.475765</td>
      <td>3803.00</td>
      <td>5</td>
      <td>359014.371364</td>
      <td>2</td>
      <td>111.664757</td>
      <td>19690.330182</td>
      <td>140.322237</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SYNTH-01</td>
      <td>1.062408</td>
      <td>3262.010706</td>
      <td>363.235125</td>
      <td>866.396198</td>
      <td>3414.25</td>
      <td>5</td>
      <td>348964.083825</td>
      <td>2</td>
      <td>212.846392</td>
      <td>51327.417300</td>
      <td>226.555550</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SYNTH-02</td>
      <td>0.861747</td>
      <td>3321.531212</td>
      <td>663.466829</td>
      <td>715.579876</td>
      <td>3341.25</td>
      <td>5</td>
      <td>285067.340599</td>
      <td>2</td>
      <td>100.423547</td>
      <td>18802.656973</td>
      <td>137.122781</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SYNTH-03</td>
      <td>0.903318</td>
      <td>2963.500000</td>
      <td>347.147868</td>
      <td>669.245998</td>
      <td>2963.50</td>
      <td>5</td>
      <td>155206.330925</td>
      <td>2</td>
      <td>63.041344</td>
      <td>5242.347575</td>
      <td>72.404058</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SYNTH-04</td>
      <td>0.885146</td>
      <td>3032.000000</td>
      <td>593.850922</td>
      <td>670.940923</td>
      <td>3032.00</td>
      <td>5</td>
      <td>236673.126701</td>
      <td>2</td>
      <td>93.985535</td>
      <td>14387.186777</td>
      <td>119.946600</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code>: What column to measure on</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groupby</span></code>: What columns to form groups on. See also: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.groupby()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agg_func</span></code>: How to aggregate replicate time points. Default is “mean”. For other options see: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.agg()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_label</span></code>: What column is to use for the time measurement. This should be added by the user either as metadata or externally.</p></li>
</ul>
</section>
<section id="Display-results">
<h2>Display results<a class="headerlink" href="#Display-results" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">log_model</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 600x400 with 1 Axes&gt;, &lt;Axes: title={&#39;center&#39;: &#39;mean±SE&#39;}&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_tutorial_notebooks_GrowthCurves_16_1.png" src="../../../_images/user_guide_tutorial_notebooks_GrowthCurves_16_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">log_model</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Metadata_StrainName&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SYNTH-00&#39;</span><span class="p">]})</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 600x400 with 1 Axes&gt;, &lt;Axes: title={&#39;center&#39;: &#39;mean±SE&#39;}&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/user_guide_tutorial_notebooks_GrowthCurves_17_1.png" src="../../../_images/user_guide_tutorial_notebooks_GrowthCurves_17_1.png" />
</div>
</div>
<p>If we want to display only one of the strains, we can use the criteria like above. You can specify which column you want to filter by as a key and provide the</p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Background">Background</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Logistic-Kinetics-Model">Logistic Kinetics Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Loss-Function">Loss Function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-in-metadata-post-analysis-for-downstream-processing">Adding in metadata post-analysis for downstream processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-in-metadata-like-strain-name">Adding in metadata like strain name</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Filtering-and-correction">Filtering and correction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Fit-model">Fit model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Display-results">Display results</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/user_guide/tutorial/notebooks/GrowthCurves.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, ExFAB BioFoundry.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>